# I&C Engineering Skill Suite

## Vision Statement

A comprehensive set of AI-powered skills to assist Instrument & Control Engineers in detailed engineering design work from a **consultant/contractor perspective**. These skills support multiple control system types (DCS, ESD, F&G, SCADA, PLC) and multiple vendors, starting with Yokogawa.

> **Note**: This skill set focuses on detailed engineering from a consultant/contractor viewpoint. Vendor-specific system configuration and programming will be addressed in a separate skill set.

---

## Design Philosophy: Specification-First Approach

Based on industry best practices for AI agent development, we adopt a **Specification-Driven Development (SDD)** approach:

> "The new scarce skill is writing specifications that fully capture your intent and values. Specifications, not prompts or code, are becoming the fundamental unit of programming." - Sean Grove, OpenAI

**Key Principles:**
1. Define clear specifications before implementation
2. Specifications serve as shared context for AI agents
3. Code becomes the implementation of well-defined specs
4. Enables multi-variant implementations with ease

**Source**: [Spec-Driven Development: The Key to Scalable AI Agents](https://thenewstack.io/spec-driven-development-the-key-to-scalable-ai-agents/)

---

## Supported Control Systems

| System Type | Description | Safety Level | Typical Vendor Systems |
|-------------|-------------|--------------|------------------------|
| **DCS** | Distributed Control System | Non-safety | Yokogawa CENTUM VP, Honeywell Experion, ABB 800xA |
| **ESD** | Emergency Shutdown System | SIL 1-3 | Yokogawa ProSafe-RS, Honeywell FSC, HIMA HIMax |
| **F&G** | Fire & Gas System | SIL 1-3 | Yokogawa ProSafe-RS, Honeywell FSC, Det-Tronics |
| **PLC** | Programmable Logic Controller | Non-safety | Allen Bradley ControlLogix, Siemens S7, Yokogawa FA-M3 |
| **SCADA** | Supervisory Control | Non-safety | OSIsoft PI, Wonderware, Ignition |

---

## Skill 1: I/O Card Allocation

### Purpose
Help engineers determine how many I/O cards are needed based on an I/O list, applying proper segregation rules and spare capacity requirements.

### Input
- I/O List (Excel) containing:
  - Tag Number
  - Signal Type (AI, AO, DI, DO, RTD, TC, etc.)
  - System Assignment (DCS, ESD, F&G, PLC)
  - Area/Unit
  - Service Description

### Output
- I/O Card Count Summary per system
- Detailed I/O Module allocation table
- Controller assignment recommendations
- Spare capacity report

### Engineering Rules

#### 1. Spare Capacity Standards
Based on industry best practices:

| Component | Minimum Spare | Notes |
|-----------|---------------|-------|
| I/O Channels | 20% | Per I/O type (AI, AO, DI, DO) |
| Controllers | 20% CPU/Memory | After counting installed spares |
| Cabinets | 20% space | For future expansion |

> "Most projects design for about 20% spare capacity in DCS, PLC etc. These spares are required as cumulative, not as per individual location/cabinet wise."
>
> **Source**: [Control System Spares - Example Calculations](https://instrumentationtools.com/control-system-spares/)

#### 2. I/O Module Channel Density (Yokogawa Examples)

| Module Type | Channels | System | Notes |
|-------------|----------|--------|-------|
| AAI143-H00 | 8 AI | CENTUM VP | 4-20mA, HART |
| AAI543-H00 | 8 AI | CENTUM VP | Isolated |
| AAO143-H00 | 8 AO | CENTUM VP | 4-20mA, HART |
| ADV151-P00 | 32 DI | CENTUM VP | 24VDC |
| ADV551-P00 | 32 DO | CENTUM VP | 24VDC |
| ATI4D-00 | 8 AI | ProSafe-RS | SIL3, 4-20mA |
| ADI4D-00 | 16 DI | ProSafe-RS | SIL3, 24VDC |
| ADO4D-00 | 8 DO | ProSafe-RS | SIL3, 24VDC |

#### 3. Controller Segregation Philosophy

**DCS (CENTUM VP - FCS)**
- One FCS per process unit (recommended)
- Maximum 4,096 I/O points per FCS
- Consider loop scan time requirements

**ESD (ProSafe-RS - SCS)**
- Safety function segregation per SIL level
- SIL 3 functions on dedicated SCS
- Maximum 9 I/O nodes per SCS CPU
- 2oo3 voting logic signals in same controller

**F&G (ProSafe-RS - SCS)**
- Separate from ESD when possible
- Fire detection and Gas detection can share SCS
- Cause & Effect matrix drives allocation

**PLC (Allen Bradley ControlLogix)**
- Tag-based addressing (modern)
- ControlNet/EtherNet/IP architecture
- 32 DI/DO per module typical
- 8-16 AI/AO per module typical

#### 4. Signal Segregation Rules

| Signal Type | Cannot Share Card With | Reason |
|-------------|------------------------|--------|
| 4-20mA AI | 24VDC DI | Different power/grounding |
| Intrinsically Safe | Non-IS | Barrier requirements |
| SIL 3 | SIL 2 or lower | Safety integrity |
| Thermocouples | RTDs | Different measurement principles |

### Calculation Methodology

```
For each signal type (AI, AO, DI, DO, RTD, TC):
  1. Count total signals from I/O list
  2. Group by system (DCS, ESD, F&G, PLC)
  3. Apply segregation rules
  4. Calculate: Required Channels = Signal Count
  5. Calculate: With Spare = Signal Count × 1.20
  6. Calculate: Cards Needed = CEILING(With Spare / Channels per Card)
  7. Allocate to controllers based on capacity
```

**Best Practice**: "It's best to add a full spare I/O module rather than leaving only 1-2 channels unused on an existing module."

**Source**: [I/O Allocation Principles for DCS Control Systems](https://zeroinstrument.com/i-o-allocation-principles-and-i-o-point-calculation-method-for-dcs-control-systems/)

---

## Skill 2: Marshalling Cabinet Design

### Purpose
Design marshalling cabinet layout, size selection, and internal wiring based on I/O allocation results.

### Input
- I/O Card Allocation (from Skill 1)
- Cabinet location requirements
- Environmental specifications
- Cross-wiring requirements

### Output
- Cabinet size recommendations
- Terminal block layout
- Cross-wiring schedule
- Cabinet elevation drawings (future)

### Engineering Rules

#### 1. Cabinet Sizing Approach

**Traditional Marshalling:**
- Terminal blocks for each I/O point
- Cross-wiring from field terminals to I/O cards
- Requires significant panel space
- Higher installation cost

**N-IO (Network I/O) Approach (Yokogawa):**
- Software-configurable I/O at cabinet
- Reduced cross-wiring
- Signal conditioning at source
- Lower total installed cost

> "N-IO is Yokogawa's approach to accommodating late hardware and software changes during project execution. Software application engineering and hardware design can progress independently."
>
> **Source**: [Yokogawa Previews Configurable I/O](https://www.yokogawa.com/library/resources/media-publications/yokogawa-previews-configurable-i-o-independent-sis/)

#### 2. Terminal Block Standards

| Terminal Type | Application | Typical Size |
|---------------|-------------|--------------|
| Feed-through | Signal passing | 2.5mm² |
| Fused | Power distribution | 2.5mm² with 2A fuse |
| Disconnect | Loop isolation | 2.5mm² knife disconnect |
| Ground | Shield/earth | Green/yellow |
| Marshalling | Cross-wire | 1.5mm² |

#### 3. Cabinet Layout Zones

```
┌─────────────────────────────────────┐
│           CABLE ENTRY               │
├─────────────────────────────────────┤
│                                     │
│     FIELD TERMINAL BLOCKS           │
│     (Organized by area/system)      │
│                                     │
├─────────────────────────────────────┤
│                                     │
│     CROSS-WIRING AREA               │
│     (Marshalling space)             │
│                                     │
├─────────────────────────────────────┤
│                                     │
│     SYSTEM TERMINAL BLOCKS          │
│     (Organized by I/O card)         │
│                                     │
├─────────────────────────────────────┤
│     I/O CARDS / BARRIERS            │
│     (If remote I/O design)          │
├─────────────────────────────────────┤
│           CABLE EXIT                │
└─────────────────────────────────────┘
```

#### 4. Spare Capacity in Cabinets

- 20% spare terminal positions
- 20% spare cable gland positions
- Consider future I/O expansion
- Reserve space for future I/O cards (if applicable)

### Yokogawa-Specific Considerations

**CENTUM VP with N-IO:**
- N-IO modules can be remote or in cabinet
- ESB (Enhanced Sequence Bus) connection
- Supports HART pass-through
- Software configurable AI/AO/DI/DO

**ProSafe-RS with N-IO:**
- SIL3 rated N-IO available
- Separate safety network (SSB)
- Redundant communication options

---

## Skill 3: Interconnection Diagram Generation (Current Implementation)

### Purpose
Generate PDF interconnection diagrams showing field wiring from instruments through junction boxes to marshalling cabinets.

### Input
- I/O List (Excel)
- Junction Box assignments
- Cabinet assignments
- Project configuration

### Output
- Multi-page PDF interconnection diagrams
- Cable schedule
- Terminal allocation report

### Current Features (Implemented)
- Analog/Digital signal segregation
- IAJB (Analog JB) / IDJB (Digital JB) classification
- 20% spare terminal allocation
- Multipair cable sizing (5/10/20 pairs)
- Branch cable specifications (ISTP/OS)
- Professional drawing layout (A3 size)
- Title block generation

### Engineering Rules (Implemented)

#### Signal Classification
| Signal Type | JB Type | Cable Spec | Terminal Allocation |
|-------------|---------|------------|---------------------|
| 4-20mA AI | IAJB | ISTP 1Px1.5mm² | 2 terminals + shield |
| 4-20mA AO | IAJB | ISTP 1Px1.5mm² | 2 terminals + shield |
| 24VDC DI | IDJB | OS 1Px1.5mm² | 2 terminals |
| 24VDC DO | IDJB | OS 1Px1.5mm² | 2 terminals |

#### Multipair Sizing
```
Instruments + 20% spare → Select from [5, 10, 20] pairs
Example: 8 instruments → 8 × 1.2 = 9.6 → 10-pair cable
```

---

## User Interface Design

### Proposed Workflow

```
┌─────────────────────────────────────────────────────────────────┐
│                    I&C ENGINEERING SKILL SUITE                  │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  1. Upload I/O List                    [Choose File]            │
│     ────────────────────────────────────────────────────        │
│                                                                 │
│  2. Select Control System Vendor                                │
│     ┌─────────────────────────────────────────────┐             │
│     │ ○ Yokogawa  ○ Honeywell  ○ Allen Bradley    │             │
│     │ ○ Siemens   ○ ABB        ○ Other            │             │
│     └─────────────────────────────────────────────┘             │
│                                                                 │
│  3. Select System Type                                          │
│     ┌─────────────────────────────────────────────┐             │
│     │ □ DCS    □ ESD    □ F&G    □ PLC    □ SCADA│             │
│     └─────────────────────────────────────────────┘             │
│                                                                 │
│  4. Select Skill to Execute                                     │
│     ┌─────────────────────────────────────────────┐             │
│     │ [I/O Card Allocation]                       │             │
│     │ [Marshalling Cabinet Design]                │             │
│     │ [Interconnection Diagrams]                  │             │
│     └─────────────────────────────────────────────┘             │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

---

## Implementation Roadmap

### Phase 1: Foundation (Current State)
- [x] Excel I/O list parser
- [x] Instrument classification engine
- [x] Analog/Digital JB segregation
- [x] Terminal allocation with 20% spare
- [x] Multipair cable sizing
- [x] PDF interconnection diagram generation
- [x] Flask web interface

### Phase 2: I/O Card Allocation Skill
- [ ] Yokogawa CENTUM VP I/O module database
- [ ] Yokogawa ProSafe-RS I/O module database
- [ ] I/O count calculation engine
- [ ] Spare capacity calculator
- [ ] Controller sizing recommendations
- [ ] I/O allocation report generator

### Phase 3: Marshalling Cabinet Skill
- [ ] Cabinet size database
- [ ] Terminal block layout engine
- [ ] Cross-wiring calculator
- [ ] Cabinet bill of materials
- [ ] Integration with I/O allocation

### Phase 4: Multi-Vendor Support
- [ ] Allen Bradley ControlLogix database
- [ ] Honeywell Experion/FSC database
- [ ] Siemens S7 database
- [ ] Vendor-agnostic abstraction layer

### Phase 5: Claude Code Skills Integration
- [ ] Convert to Claude Code SKILL.md format
- [ ] Create command-based invocation
- [ ] Add conversational guidance
- [ ] Implement progress tracking

---

## Yokogawa System Reference

### CENTUM VP (DCS)
- Field Control Station (FCS)
- N-IO for software-configurable I/O
- Up to 100,000 tags per system
- Supports PROFINET, HART 7
- Redundant architecture available

### ProSafe-RS (ESD/F&G)
- Safety Control Station (SCS)
- SIL3 certified (IEC 61508/61511)
- Up to 9 I/O nodes per SCS CPU
- Separate ESB/SSB networks
- 1oo2D voting architecture
- F&G faceplates for detector monitoring

**Source**: [Yokogawa Safety Instrumented Systems](https://www.yokogawa.com/us/solutions/products-and-services/control/control-and-safety-system/safety-instrumented-systems-sis/)

---

## Data Model Extensions Required

### I/O Card Model
```python
@dataclass
class IOCard:
    vendor: str              # "Yokogawa", "Allen Bradley", etc.
    model: str               # "AAI143-H00"
    system_type: str         # "DCS", "ESD", "F&G", "PLC"
    signal_type: str         # "AI", "AO", "DI", "DO"
    channel_count: int       # 8, 16, 32
    safety_rated: bool       # SIL certification
    sil_level: Optional[int] # 1, 2, 3, or None
    supports_hart: bool
    supports_is: bool        # Intrinsically safe
```

### Controller Model
```python
@dataclass
class Controller:
    vendor: str
    model: str               # "AFV30D" (FCS), "SSC60D" (SCS)
    system_type: str
    max_io_points: int
    max_io_nodes: int
    redundancy_capable: bool
    scan_rate_ms: int
```

### Cabinet Model
```python
@dataclass
class MarshallingCabinet:
    tag: str
    dimensions: Tuple[int, int, int]  # H x W x D in mm
    terminal_capacity: int
    systems: List[str]       # ["DCS", "ESD"]
    has_remote_io: bool
    io_cards: List[IOCard]
```

---

## References

### Yokogawa Documentation
- [CENTUM VP N-IO Overview](https://www.yokogawa.com/library/resources/media-publications/yokogawa-previews-configurable-i-o-independent-sis/)
- [ProSafe-RS Safety System](https://www.yokogawa.com/us/solutions/products-and-services/control/control-and-safety-system/safety-instrumented-systems-sis/)
- [ProSafe-RS R4.03.00 Enhancements](https://www.yokogawa.com/eu/news/press-releases/2017/yokogawa-releases-enhanced-version-of-prosafer-rs-safety-instrumented-system-r4_03_00/)

### Industry Standards
- IEC 61508 - Functional Safety
- IEC 61511 - Safety Instrumented Systems for Process Industries
- ISA-5.1 - Instrumentation Symbols and Identification

### Engineering Best Practices
- [I/O Allocation Principles for DCS](https://zeroinstrument.com/i-o-allocation-principles-and-i-o-point-calculation-method-for-dcs-control-systems/)
- [DCS I/O Spare Capacity Guidelines](https://zeroinstrument.com/how-much-spare-capacity-should-be-reserved-for-dcs-i-o-modules-and-controllers/)
- [Control System Spares Calculations](https://instrumentationtools.com/control-system-spares/)

### AI Agent Development
- [Spec-Driven Development for AI Agents](https://thenewstack.io/spec-driven-development-the-key-to-scalable-ai-agents/)
- [Building Effective AI Agents - Anthropic](https://www.anthropic.com/engineering/building-effective-agents)

---

*Document Version: 1.0*
*Last Updated: December 2024*
*Author: Nayyer / Claude*
